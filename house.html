<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Embed External HTML</title>
</head>
<body>
    <div id="embed-container"></div>

    <script>
        // URL of the external HTML file
        const url = "https://cdn.jsdelivr.net/gh/HouseOfHazards/HouseOfHazards.github.io@main/index.html";

        // Base URL for resources on the CDN
        const baseUrl = "https://cdn.jsdelivr.net/gh/HouseOfHazards/HouseOfHazards.github.io@main/";

        // Function to fetch and render HTML
        async function fetchAndRenderHTML() {
            try {
                // Fetch the HTML content
                const response = await fetch(url);
                let html = await response.text();

                // Temporarily prevent the redirect by removing the window.location script
                html = html.replace(/<script.*?window\.location=.*?<\/script>/, '');

                // Inject the raw HTML content into the div (no modification of URLs yet)
                document.getElementById('embed-container').innerHTML = html;

                // Now that the HTML is loaded, let's fix the URLs dynamically
                fixResourceUrls();

                // After a delay, trigger the redirect manually
                setTimeout(() => {
                    window.location = "https://ubg44.github.io/HouseOfHazards/"; // Re-enable the redirect
                }, 3000); // Adjust delay if necessary (3 seconds here)
            } catch (error) {
                console.error("Error fetching HTML:", error);
            }
        }

        // Function to dynamically fix the resource URLs
        function fixResourceUrls() {
            // Select all <link>, <script>, <img>, and other tags that might contain resources
            const resourceElements = document.querySelectorAll('link, script, img, iframe');

            resourceElements.forEach(element => {
                let url = element.href || element.src;
                
                // If the URL is relative, append the base URL
                if (url && !url.startsWith('http') && !url.startsWith('https') && !url.startsWith('//')) {
                    const newUrl = baseUrl + url;
                    if (element.href) {
                        element.href = newUrl; // For <link> elements
                    } else if (element.src) {
                        element.src = newUrl; // For <script>, <img>, <iframe> elements
                    }
                }
            });
        }

        // Call the function to render the HTML
        fetchAndRenderHTML();
    </script>
</body>
</html>
